!function(e){function t(n){if(r[n])return r[n].exports;var s=r[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=4)}([function(e,t){e.exports=require("express")},function(e,t){e.exports=require("mongoose")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8),s=r(9),o=function(){function e(){}return e.clearDB=function(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,s.SurveyModel.remove({})];case 1:return e.sent(),t.status(200).send({code:0,message:"success"}),[2]}})})},e.getById=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,o,u;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=e.params.id,[4,s.SurveyModel.findById(r)];case 1:return o=n.sent(),o||t.status(200).send({code:-1,message:"Survey not found"}),t.status(200).send({code:0,message:"success",data:o}),[3,3];case 2:return u=n.sent(),t.status(200).send({code:-4,message:u.data}),[3,3];case 3:return[2]}})})},e.list=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(r){switch(r.label){case 0:return[4,s.SurveyModel.find({})];case 1:return e=r.sent(),t.status(200).send({code:0,data:e}),[2]}})})},e.saveSurvey=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,o,u,i,a,c,d;return n.__generator(this,function(n){switch(n.label){case 0:return r=e.body.info,o=r.title,u=r.description,i=r.action,a=e.body.content,c={title:o,description:u,content:JSON.stringify(a),author:"son",status:i},e.body.id?[3,2]:[4,s.SurveyModel.create(c)];case 1:return d=n.sent(),[3,4];case 2:return[4,s.SurveyModel.update({_id:e.body.id},c)];case 3:d=n.sent(),n.label=4;case 4:return d?t.status(200).send({code:0,message:"Success",data:d}):t.status(200).send({code:1,message:"Error"}),[2]}})})},e.submitSurvey=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,o,u,i,a,c;return n.__generator(this,function(n){switch(n.label){case 0:return r=e.body.info,o=r.title,u=r.description,i=e.body.content,a={title:o,description:u,content:JSON.stringify(i),author:"son"},[4,s.SurveyModel.create(a)];case 1:return c=n.sent(),c?t.status(200).send({code:0,message:"SUCCESS",data:c}):t.status(200).send({code:1,message:"Error"}),[2]}})})},e.getAllResponse=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,s.ClientSurveyModel.find({})];case 1:return e=n.sent(),t.status(200).send({code:0,data:e}),[3,3];case 2:return r=n.sent(),[3,3];case 3:return[2]}})})},e.clearAllResponse=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var e;return n.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,s.ClientSurveyModel.remove({})];case 1:return r.sent(),t.status(200).send({code:0,message:"Success"}),[3,3];case 2:return e=r.sent(),t.status(200).send({code:-1,message:e.message}),[3,3];case 3:return[2]}})})},e.createResponse=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,o,u,i,a,c;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),r=e.body.question,o=e.body.survey_id,u=void 0,[4,s.SurveyModel.findById(o)];case 1:return u=n.sent(),i=new s.ClientSurveyModel({content:JSON.stringify(r),status:"active",survey_id:u._id}),[4,s.ClientSurveyModel.create(i)];case 2:return a=n.sent(),a?t.status(200).send({code:0,message:"Success"}):t.status(200).send({code:1,message:"Error"}),[3,4];case 3:return c=n.sent(),t.status(200).send({code:1,message:c.message}),[3,4];case 4:return[2]}})})},e.getBySurvey=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,o;return n.__generator(this,function(n){switch(n.label){case 0:return r=e.params.id,[4,s.ClientSurveyModel.find({survey_id:r})];case 1:return o=n.sent(),t.status(200).send({code:0,data:o}),[2]}})})},e}();t.default=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10);t.jsonParser=n.json(),t.urlEncodedParser=n.urlencoded({extended:!1})},function(e,t,r){e.exports=r(5)},function(e,t,r){"use strict";(function(e){function n(e,t,r){t.header("Access-Control-Allow-Origin","*"),t.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),r()}Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),o=r(1),u=r(7),i=r(11),a=s(),c=Object({NODE_ENV:"production"}).PORT||3e3,d=Object({NODE_ENV:"production"}).IP,l=function(){return console.log("Server is listening... "+(d||"localhost")+":"+c)},f={server:{socketOptions:{keepAlive:3e5,connectTimeoutMS:3e4}},replset:{socketOptions:{keepAlive:3e5,connectTimeoutMS:3e4}}};!function(){o.connect("mongodb://localhost/form_database",f),o.Promise=e.Promise}(),a.use(n),a.use("/survey",u),a.use("/client-survey",i),a.listen(c,d,l)}).call(t,r(6))},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),s=r(3),o=r(0),u=o.Router();u.get("/",n.default.list),u.get("/:id",n.default.getById),u.post("/",s.jsonParser,n.default.saveSurvey),e.exports=u},function(e,t){e.exports=require("tslib")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),s=new n.Schema({title:String,description:String,author:{id:{type:n.SchemaTypes.ObjectId,ref:"User"},username:String},content:n.SchemaTypes.Mixed,completed:Boolean}),o=n.model("Survey",s);t.SurveyModel=o;var u=new n.Schema({survey_id:{type:n.SchemaTypes.ObjectId,ref:"Survey"},content:n.SchemaTypes.Mixed,completed:Boolean}),i=n.model("ClientSurvey",u);t.ClientSurveyModel=i},function(e,t){e.exports=require("body-parser")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),s=r(3),o=r(0),u=o.Router();u.get("/",n.default.getAllResponse),u.get("/:id",n.default.getBySurvey),u.post("/",s.jsonParser,n.default.createResponse),e.exports=u}]);